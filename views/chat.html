{% include "layout.html" %}

{% include "title.html" %}

{% include "navbar.html" %}


    <div id="chat">
        <div class='chat-container'>
            <div class="chat-interface">
                {% for msg in messages %}
                <div class="messageContainer">
                    <p class="date">{{msg.author}}</p>
                    <p class="message">
                        {{ msg.content }}
                    </p>
                </div>                
                {% endfor %}
            </div>
            <div class="bottom-chat">
                <input type="textfield" id="message-content">
                <button type="submit" id="sendMsg">Envoyer</button>
            </div>
        </div>
    </div>
{% include "footer.html" %}

<script>

    // Initialise la connexion au serveur Socket.IO
    const socket = io()
    // // Une fois connecté, l'evenement "connect" est déclenché
    // socket.on('connect', () => {
    //     console.log('connected !')
    //     // Envoi de l'event "event-name" au serveur
    //     socket.emit('event-name', { ladata: 'bonjour' })
    // })
    

    function displayMessage(htmlMessage) {
        document.querySelector(".chat-interface").innerHTML += htmlMessage
    }

    window.addEventListener('load', function () {

        // let messageExample = {
        //     content: "salut c'est un message",
        //     time: Date.now()
        // }

        // let htmlMessage = '<div class="messageContainer"><p class="date">' + messageExample.time
        //  + ' : </p><p class="message">' + messageExample.content + '</p></div>'

        document.querySelector("#sendMsg").addEventListener("click", ()=>{
            //displayMessage(htmlMessage)
            let content = document.getElementById('message-content').value
            
            socket.emit('message-sent', { 
                content: content, 
                cookie : document.cookie
            })
        })
    })

    
</script>
